---
title: "Analisis_avanzado"
output: html_document
---

# Análisis Avanzado

## Modificación del dataset

```{r}
# Leemos los datos del CSV
data <- read.csv('heart.csv')

# Creamos los datos de forma aleatoria
weigth <- sample(c(6000:15000), 918, replace = TRUE)/100
heigth <- sample(c(140:200), 918, replace = TRUE)/100
countries <- c('Spain', 'France', 'Germany', 'England', 'Portugal', 'Cuba', 'China', 'South Africa', 'Italy')
country <- sample(countries, 918, replace = TRUE)

# Los agregamos al dataframe
data$Weigth <- weigth
data$Heigth <- heigth
data$Country <- country
data <- tibble::rowid_to_column(data, "ID")

# Visualizamos los datos
View(data)

# Exportamos los nuevos datos a un CSV
write.csv(data,"heart3.csv", row.names = FALSE)
```

## Preprocesamiento y visualización de datos

```{r}

```

## Aplicación del análisis no supervisado

### Clustering Jeraquizado
A continuación vamos a realizar un análisis de Cluster Jerarquizado sobre el dataset modificado.

```{r}
library(cluster)
library(purrr)
data <- read.csv('heart2.csv')

# Añadimos un identificador a cada dato
data <- tibble::rowid_to_column(data, "ID")
data <- na.omit(data)

# Nos quedamos solo con las variables numéricas y no binarias
data <- data[,c(1,2,5,6,7,9,14,15)] #

# Dissimilarity matrix
d <- dist(data, method = "euclidean")
# Hierarchical clustering using Complete Linkage
hc1 <- hclust(d, method = "complete" )
# Plot the obtained dendrogram
plot(hc1, cex = 0.6, hang = -1)
```

```{r}
plot(hc1, cex = 0.6, hang = -1)
rect.hclust(hc1, k = 7, border = 2:5)
```
```{r}
clust <- cutree(hc1, k = 3)

library(factoextra)

fviz_cluster(list(data = data, cluster = clust)) 
```