---
title: "Analisis_avanzado"
output: html_document
---

# Análisis Avanzado

## Modificación del dataset

```{r}
# Leemos los datos del CSV
data <- read.csv('heart.csv')

# Creamos los datos de forma aleatoria
weigth <- sample(c(6000:15000), 918, replace = TRUE)/100
heigth <- sample(c(140:200), 918, replace = TRUE)/100
countries <- c('Spain', 'France', 'Germany', 'England', 'Portugal', 'Cuba', 'China', 'South Africa', 'Italy')
country <- sample(countries, 918, replace = TRUE)

# Los agregamos al dataframe
data$Weigth <- weigth
data$Heigth <- heigth
data$Country <- country

# Visualizamos los datos
View(data)

# Exportamos los nuevos datos a un CSV
write.csv(data,"heart3.csv", row.names = FALSE)
```

## Preprocesamiento y visualización de datos

```{r}

```

## Aplicación del análisis no supervisado

### Clustering Jeraquizado

```{r}
data <- read.csv('heart2.csv', head = TRUE, na = "")

library(ClustOfVar)

xquant <- data[,c(1,4,5,6,8,10,12,13,14)] # Numeric variables
xqual <- data[,c(2,3,7,9,11,15)]          # Categorical variables

tree <- hclustvar(xquant, xqual)
plot(tree)
```

```{r}
library(cluster)

d <- dist(data, method="euclidean")
# Keep in mind that this is only for mixed numeric and categorical data.
# See the note below if you are using only numeric variables.

fit <- hclust(d=d, method="complete")    # Also try: method="ward.D"   
plot(fit, hang=-1)
groups <- cutree(fit, k=4)   # "k=" defines the number of clusters you are using   
rect.hclust(fit, k=4, border="red") # draw dendogram with red borders around the 4 clusters   
```

```{r}
kfit <- kmeans(d, 3)
clusplot(as.matrix(d), kfit$cluster, color=T, shade=T, labels=2, lines=0)
```

